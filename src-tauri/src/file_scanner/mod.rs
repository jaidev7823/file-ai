// Public API and main orchestration logic